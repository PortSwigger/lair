/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package lair.models;

import com.mongodb.BasicDBObject;
import java.util.ArrayList;

/**
 *
 * @author dkottmann
 */
public class Vulnerability extends BasicDBObject {

    public Vulnerability() {
        super();
        this.setStatus(Constants.STATUS_GREY);
        this.setConfirmed(false);
        this.setCvss(0.0);
        this.setCves(new ArrayList<String>());
        this.setNotes(new ArrayList<Note>());
    }
    
    public Vulnerability(BasicDBObject base) {
        super(base);
    }

    public String getId() {
        return this.getString("_id");
    }

    public void setId(String id) {
        this.put("_id", id);
    }
    
    /**
     * @return the projectId
     */
    public String getProjectId() {
        return this.getString("project_id");
    }

    /**
     * @param projectId the projectId to set
     */
    public void setProjectId(String projectId) {
        this.put("project_id", projectId);
    }

    /**
     * @return the title
     */
    public String getTitle() {
        return this.getString("title");
    }

    /**
     * @param title the title to set
     */
    public void setTitle(String title) {
        this.put("title", title);
    }

    /**
     * @return the description
     */
    public String getDescription() {
        return this.getString("title");
    }

    /**
     * @param description the description to set
     */
    public void setDescription(String description) {
        this.put("description", description);
    }

    /**
     * @return the solution
     */
    public String getSolution() {
        return this.getString("solution");
    }

    /**
     * @param solution the solution to set
     */
    public void setSolution(String solution) {
        this.put("solution", solution);
    }

    /**
     * @return the status
     */
    public String getStatus() {
        return this.getString("status");
    }

    /**
     * @param status the status to set
     */
    public void setStatus(String status) {
        this.put("status", status);
    }

    /**
     * @return the cvss
     */
    public double getCvss() {
        return this.getDouble("cvss");
    }

    /**
     * @param cvss the cvss to set
     */
    public void setCvss(double cvss) {
        this.put("cvss", cvss);
    }

    public ArrayList<String> getCves() {
        return (ArrayList<String>) this.get("cves");
    }

    public void setCves(ArrayList<String> cves) {
        this.put("cves", cves);
    }

    public ArrayList<PluginId> getPluginIds() {
        ArrayList<PluginId> ret = new ArrayList<PluginId>();
        for (BasicDBObject obj : (ArrayList<BasicDBObject>) this.get("plugin_ids")) {
            ret.add(new PluginId(obj));
        }
        return ret;
    }

    public void setPluginIds(ArrayList<PluginId> pluginIds) {
        this.put("plugin_ids", pluginIds);
    }

    public ArrayList<PluginId> getIdentifiedBy() {
        ArrayList<PluginId> ret = new ArrayList<PluginId>();
        for (BasicDBObject obj : (ArrayList<BasicDBObject>) this.get("identified_by")) {
            ret.add(new PluginId(obj));
        }
        return ret;
    }

    public void setIdentifiedBy(ArrayList<PluginId> pluginIds) {
        this.put("identified_by", pluginIds);
    }

    /**
     * @return the confirmed
     */
    public boolean isConfirmed() {
        return this.getBoolean("confirmed");
    }

    /**
     * @param confirmed the confirmed to set
     */
    public void setConfirmed(boolean confirmed) {
        this.put("confirmed", confirmed);
    }

    public ArrayList<Note> getNotes() {
        ArrayList<Note> ret = new ArrayList<Note>();
        for (BasicDBObject obj : (ArrayList<BasicDBObject>) this.get("notes")) {
            ret.add(new Note(obj));
        }
        return ret;
    }

    public void setNotes(ArrayList<Note> notes) {
        this.put("notes", notes);
    }

    /**
     * @return the evidence
     */
    public String getEvidence() {
        return this.getString("evidence");
    }

    /**
     * @param evidence the evidence to set
     */
    public void setEvidence(String evidence) {
        this.put("evidence", evidence);
    }

    public ArrayList<HostRef> getHosts() {
        ArrayList<HostRef> ret = new ArrayList<HostRef>();
        for (BasicDBObject obj : (ArrayList<BasicDBObject>) this.get("hosts")) {
            ret.add(new HostRef(obj));
        }
        return ret;
    }

    public void setHosts(ArrayList<HostRef> hosts) {
        this.put("hosts", hosts);
    }

    /**
     * @return the lastModifiedBy
     */
    public String getLastModifiedBy() {
        return this.getString("last_modified_by");
    }

    /**
     * @param lastModifiedBy the lastModifiedBy to set
     */
    public void setLastModifiedBy(String lastModifiedBy) {
        this.put("last_modified_by", lastModifiedBy);
    }

    /**
     * @return the flag
     */
    public boolean isFlag() {
        return this.getBoolean("flag");
    }

    /**
     * @param flag the flag to set
     */
    public void setFlag(boolean flag) {
        this.put("flag", flag);
    }

}
